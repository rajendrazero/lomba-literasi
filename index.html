 <!doctype html>
<html lang="id" x-data="bookletApp()" x-init="loadData()">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ“˜ Booklet Ekskul Literasi</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <style>
    .text-primary { color: #0b5fab; }
    .bg-primary { background-color: #0b5fab; }
    .rotate-90 { transform: rotate(90deg); }
    .transition-transform { transition: transform 0.2s ease; }
  </style>
</head>

<body class="bg-gradient-to-b from-white to-blue-50 font-sans text-gray-900 min-h-screen">
  <div class="max-w-6xl mx-auto p-6 space-y-10">

    <!-- ================= HEADER ================= -->
    <template x-for="(event, i) in data.events" :key="i">
      <section class="bg-white shadow rounded-xl p-6 space-y-6">

        <!-- HEADER EVENT -->
        <header class="flex justify-between items-center flex-wrap border-b pb-3">
          <div>
            <h1 class="text-2xl font-bold text-primary" x-text="event.title"></h1>
            <p class="text-sm text-gray-600">
              Tema: <strong x-text="event.theme"></strong><br>
              Update: <span x-text="event.last_update"></span>
            </p>
          </div>
          <a :href="event.whatsapp" target="_blank"
             class="bg-green-600 text-white px-4 py-2 rounded-lg text-sm shadow hover:bg-green-700">
             ğŸ’¬ Join WA Group
          </a>
        </header>

        <!-- ================= ATURAN UMUM ================= -->
        <section class="bg-blue-50 border border-blue-100 rounded-lg p-4">
          <h2 class="font-semibold text-primary mb-2">ğŸ“˜ Aturan Umum Festival</h2>
          <ul class="list-disc pl-6 text-sm text-gray-800 space-y-1">
            <template x-for="rule in event.general_rules" :key="rule">
              <li x-text="rule"></li>
            </template>
          </ul>
        </section>

        <!-- ================= PENDAFTARAN ================= -->
        <section class="bg-gray-50 border border-gray-100 rounded-lg p-4">
          <h2 class="font-semibold text-primary mb-2">ğŸ“ Ketentuan Pendaftaran</h2>
          <p><strong>Biaya:</strong> <span x-text="event.registration.fee"></span></p>
          <p class="mt-2"><strong>Persyaratan:</strong></p>
          <ul class="list-disc pl-6 text-sm">
            <template x-for="req in event.registration.requirements" :key="req">
              <li x-text="req"></li>
            </template>
          </ul>
          <!-- <a :href="event.registration.link" target="_blank"
             class="inline-block mt-3 bg-primary text-white px-4 py-2 rounded-lg text-sm shadow hover:bg-blue-700"> -->
<!--              ğŸ”— Formulir Pendaftaran Umum -->
          </a>
        </section>

        <!-- ================= FILE & HADIAH ================= -->
        <div class="grid md:grid-cols-2 gap-4">
          <section class="bg-gray-50 border rounded-lg p-4">
            <h2 class="font-semibold text-primary mb-2">ğŸ“‚ File Pendukung</h2>
            <ul class="list-disc pl-6 text-sm">
              <template x-for="f in event.files" :key="f.name">
                <li><a :href="f.url" target="_blank" class="text-blue-600 hover:underline" x-text="f.name"></a></li>
              </template>
            </ul>
          </section>

          <section class="bg-gray-50 border rounded-lg p-4">
            <h2 class="font-semibold text-primary mb-2">ğŸ† Hadiah & Penghargaan</h2>
            <ul class="list-decimal pl-6 text-sm">
              <template x-for="p in event.prizes" :key="p"><li x-text="p"></li></template>
            </ul>
          </section>
        </div>

        <!-- ================= DAFTAR LOMBA ================= -->
        <section class="space-y-4 mt-6">
          <h2 class="text-lg font-bold text-primary">ğŸ­ Daftar Cabang Lomba</h2>
          <template x-for="(cat, j) in event.categories" :key="j">
            <div x-data="{ open: false }" class="border rounded-lg overflow-hidden bg-white shadow-sm">
              <button @click="open = !open"
                      class="w-full text-left px-4 py-3 flex justify-between items-center hover:bg-blue-50 transition">
                <span>
                  <span class="font-semibold text-primary" x-text="cat.name"></span>
                  <span class="text-sm text-gray-500" x-text="' â€” ' + cat.type.toUpperCase()"></span>
                </span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform"
                     :class="open ? 'rotate-90' : ''" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </button>

              <!-- Detail -->
              <div x-show="open" x-collapse class="border-t p-4 bg-gray-50 space-y-3 text-sm">
                <p class="text-gray-700" x-text="cat.desc"></p>
                <div>
                  <h4 class="font-semibold text-primary">ğŸ“œ Peraturan</h4>
                  <ul class="list-disc pl-6">
                    <template x-for="r in cat.rules" :key="r"><li x-text="r"></li></template>
                  </ul>
                </div>
                <div>
                  <h4 class="font-semibold text-primary mt-2">ğŸ… Kriteria</h4>
                  <ul class="list-decimal pl-6">
                    <template x-for="c in cat.criteria" :key="c"><li x-text="c"></li></template>
                  </ul>
                </div>

                <!-- PUISI -->
                <template x-if="cat.type === 'puisi' && cat.extras && cat.extras.poems">
                  <div class="mt-3">
                    <h4 class="font-semibold text-primary">ğŸ“– Puisi Wajib</h4>
                    <template x-for="poem in cat.extras.poems" :key="poem.judul">
                      <div class="bg-white rounded-lg border p-3 mt-2">
                        <h5 class="font-semibold" x-text="poem.judul"></h5>
                        <p class="text-xs italic text-gray-600" x-text="'â€” ' + poem.pengarang"></p>
                        <pre class="text-sm text-gray-700 whitespace-pre-wrap mt-1" x-text="poem.teks"></pre>
                      </div>
                    </template>
                  </div>
                </template>

                <!-- PIDATO -->
                <template x-if="cat.type === 'pidato' && cat.extras && cat.extras.speech">
                  <div class="mt-3">
                    <h4 class="font-semibold text-primary">ğŸ—£ï¸ Naskah Pidato</h4>
                    <p class="font-semibold" x-text="cat.extras.speech.judul"></p>
                    <pre class="text-sm text-gray-700 whitespace-pre-wrap mt-1" x-text="cat.extras.speech.teks"></pre>
                  </div>
                </template>

                <a :href="cat.link" target="_blank"
                   class="inline-block bg-primary text-white px-4 py-2 rounded-lg text-xs hover:bg-blue-700 shadow">
                   ğŸ”— Daftar Cabang Ini
                </a>
              </div>
            </div>
          </template>
        </section>

        <!-- ================= PANITIA ================= -->
        <section class="bg-gray-50 rounded-lg p-4 mt-6">
          <h2 class="font-semibold text-primary mb-2">ğŸ“ Kontak Panitia</h2>
          <ul class="space-y-1 text-sm">
            <template x-for="p in event.panitia" :key="p.name">
              <li><strong x-text="p.name"></strong> â€” <a :href="'https://wa.me/' + p.phone" target="_blank"
                  class="text-blue-600 hover:underline" x-text="'+' + p.phone"></a></li>
            </template>
          </ul>
        </section>

      </section>
    </template>

    <footer class="text-center text-gray-500 text-sm py-6 border-t">
      Â© Ekskul Literasi SMKN 9 Medan â€” <span x-text="new Date().getFullYear()"></span>
    </footer>
  </div>

  <script>
    function bookletApp() {
      return {
        jsonBinId: "6910521543b1c97be9a23370",
        apiKey: "$2a$10$7imEXBjuQHy3kKGZyBZccumUxrrVRKqAlShV.sIjByFJhLXona.f6",
        data: { events: [] },
        async loadData() {
          try {
            const res = await fetch(`https://api.jsonbin.io/v3/b/${this.jsonBinId}/latest`, {
              headers: { "X-Master-Key": this.apiKey }
            });
            const json = await res.json();
            this.data = json.record;
          } catch (err) {
            console.error("âŒ Gagal memuat data:", err);
          }
        }
      };
    }
  </script>
</body>
</html>
